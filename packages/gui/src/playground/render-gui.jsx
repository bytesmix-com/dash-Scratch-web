import React from "react";
import ReactDOM from "react-dom";
import { compose } from "redux";

import AppStateHOC from "../lib/app-state-hoc.jsx";
import GUI from "../containers/gui.jsx";
import HashParserHOC from "../lib/hash-parser-hoc.jsx";
import log from "../lib/log.js";

const onClickLogo = () => {
  window.location = "https://scratch.mit.edu";
};

const handleTelemetryModalCancel = () => {
  log("User canceled telemetry modal");
};

const handleTelemetryModalOptIn = () => {
  log("User opted into telemetry");
};

const handleTelemetryModalOptOut = () => {
  log("User opted out of telemetry");
};

/*
 * Render the GUI playground. This is a separate function because importing anything
 * that instantiates the VM causes unsupported browsers to crash
 * {object} appTarget - the DOM element to render to
 */
export default (appTarget) => {
  GUI.setAppElement(appTarget);

  // note that redux's 'compose' function is just being used as a general utility to make
  // the hierarchy of HOC constructor calls clearer here; it has nothing to do with redux's
  // ability to compose reducers.
  const WrappedGui = compose(AppStateHOC, HashParserHOC)(GUI);

  if (process.env.NODE_ENV === "production" && typeof window === "object") {
    // Warn before navigating away
    window.onbeforeunload = () => true;
  }

  ReactDOM.render(
    <WrappedGui
      className="gui"
      assetHost={"https://api-scratch-tutoring.stg-branch.be/gui/asset"}
      projectHost={"https://api-scratch-tutoring.stg-branch.be/gui/project"}
      canSave
      canCreateNew={false}
      basePath="/"
      backpackVisible={false}
    />,
    appTarget,
  );
};
